---
layout: default
order: 11
title:  "Genómica Parte 2"
date: 2020-06-10
time:   "mier-viernes 26-28 Ago"
categories: main
instructor: ""
materials: ""
material-type: ""
lesson-type: presencial, autoguiada, evaluada
---
<a href="https://pesalerno.github.io/genetica-ago-2020/main/2020/06/10/10_genomica-1.html"><button>Actividad Anterior</button></a>		<a href="https://pesalerno.github.io/genetica-ago-2020/"><button>Inicio</button></a>    <a href="https://pesalerno.github.io/genetica-ago-2020/main/2020/08/01/12_final.html"><button>Siguiente Actividad</button></a>

# Taller #2: Genómica Poblacional y Markdown

>**PÁGINA EN CONSTRUCCIÓN. FAVOR REVISAR MÁS TARDE**


> -------------------
> 
> **VIERNES 9-10:30am** | Sesión Sincrónica de preguntas del Taller de genómica poblacional y Markdown
> 
> ------------------------
 
 ## introducción a la bioinformática y al lenguaje Markdown 
 

 > 
 > **Fecha de entrega:** JUEVES 11 junio 11:59pm 
 > 
 > **FORMATO DE ENTREGA:** El proyecto debe ser entregado individualmente en formato `.md` o en `.pdf` (casi todos los editores MarkDown permiten exportar pdf). Copien y peguen el codigo Markdown de las proximas lineas para incluir en la entrega de su proyecto:  

 --------------------
 > 
 > **AUTOR(es) DEL PROYECTO:** 
 > 
 > **TITULO DEL PROYECTO:**  
 > 
 >  **Objetivos resumidos del proyecto:** (maximo 60 palabras)
 > 
 > **Metodologia de colecta de datos/observaciones del proyecto:** (maximo 60 palabras). 

 ------------------------
  

 ## 1. Introducción a la ciencia reproducible. 

 A pesar de que la academia tiene varios controles de calidad inherentes al sistema de revisión y publicación científica, la ciencia nos ha demostrado que algunos estudios altamente controversiales terminan teniendo datos mal analizados o simplemente inventados. Tres ejemplos de estudios controversiales que fueron retractados debido a falta de reproducibilidad y claridad de datos y de metodos son el estudio que encontro que la preferencia de niñas recien nacidas obedece a instintos maternales, el estudio que encontro que las vacunas causaban autismo, y el estudio reciente que sugirio que la hydroxycloroquina era una cura efectiva para el coronavirus. Ahora, en la era del `big data` resulta mas importante que nunca tener un `pipeline` de metodos y resultados lo suficientemente detallado como para que cualquier persona pueda reproducir nuestros gráficos y llegar a nuestras mismas conclusiones de tener los datos crudos previo a nuestro análisis. Pero, a menor escala, cualquier proyecto que tenga analisis de datos multifactoriales, como lo son casi todos los proyectos de ingeniería, biología, y ciencias sociales, se beneficia de un protocolo abierto con un formato amigable para que el lector pueda reproducirlo.  

 --------------------------------------

 > [ACCEDA AL VIDEO EXPLICATIVO DE LA ACTIVIDAD AQUI](https://www.loom.com/share/36179690260b421ca971f5c0bc607229) 

 ----------------------------------------

 Para una [publicación reciente](https://github.com/pesalerno/seminario2020/blob/master/files/Trumbo-etal-2019_Mol_Ecol.pdf) mía y de mis colaboradores de genómica del paisaje de pumas de Colorado, yo escribí una [guía paso a paso de un pipeline bioinformático](https://github.com/pesalerno/PUMAgenomics/blob/master/README.md), donde asociamos un repositorio de github y una guia de metodos y resultados (con todas las matrices de datos intermedias y finales asociadas) a datos crudos en otro repositorio para que cualquier persona pueda reproducir los métodos y conclusiones de nuestra publicación. 

 >Entonces, lo que ustedes deben hacer para su proyecto y para esta actividad es: **desarrollar una guia detallada de metodos y resultados que sea complementaria a los metodos y resultados del manuscrito del mismo proyecto.**


 ## 2. Aprendiendo código de MarkDown y desarrollando nuestra primera guía reproducible de análisis de datos. 

 Aprender Markdown no es nada difícil. Basta con que instalen un buen editor de MarkDown, que para Mac/Linux sugiero [MacDown](https://macdown.uranusjr.com/) y para PC/Windows [Typora](https://typora.io/) ya que ayudan aprender MarkDown en tiempo real, y luego que comiencen en base a cualquier archivo de Markdown a formatear sus documentos. 

 >*Si no logran instalar alguno de estos editores Markdown, por favor avisenme para ayudarles.*

 Para comenzar a desarrollar sus guías del proyecto en MarkDown, bajen el [archivo agregando texto](https://github.com/pesalerno/seminario2020/blob/master/_posts/2020-06-01-1_Semana_1.md) que estan leyendo para copiar/pegar el formato de entrega de nombre/titulo/etc. Al hacer click en los vinculos de los archivos en github, deben hacer click en `Raw` para visualizar (y copiar/pegar) el codigo directo desde la web.  


 ![](https://github.com/pesalerno/seminario2020/blob/master/files/raw-download-pic.png?raw=true)<br>



 Luego, pueden comenzar con [esta guia en línea](https://support.typora.io/Markdown-Reference/) de todos los comandos, o si quieren pueden editar alguno de mis proyectos/repositorios, como el de los [pumas de Colorado](https://github.com/pesalerno/PUMAgenomics/blob/master/README.md), o las [ranas Arlequin de Ecuador](https://github.com/pesalerno/Atelopus/blob/master/README.md). 

 --------------
 
 
 
 
 ## popgen analyses using *adegenet* in R
 


 For this lesson, we will be using a couple of different (and pre-filtered) datasets!!  The *puma* dataset is based on a couple of papers that were recently published in **biorxiv**, and the *stream insect* dataset is based on a recent paper that came out in **Ecology Letters**. 

 First, let's take a look at our structure file format (and download the [.stru file](https://raw.githubusercontent.com/rdtarvin/IBS2019_Genomics-of-Biodiversity/master/files/pumas-CO.stru)), as well as our `.R` file [found here](https://raw.githubusercontent.com/rdtarvin/IBS2019_Genomics-of-Biodiversity/master/files/adegenet-new.R). <br>

 <summary>There are a few options of how to download these files, how will you do it?</summary>
 <details>right click and save (as .stru), using curl, or open and then copy/paste into BBEdit?</details>

 Now, let's get started with our `R` code by opening R Studio and then starting a new R script (File>New File>R Script). <br>
 Before you get started, make sure you are in the workshop directory where you saved the `.stru` and the `.R` files: 

     setwd("~/Desktop/Genomics_USFQ_2019/workshop/epi")

 Then, we need to load the libraries that will be used: 

     library("adegenet")
     library("ggplot2")


 Now, we import our first SNP dataset, Colorado pumas, and name it ***myFile*** by writing:

     myFile <- import2genind("pumas-CO.stru") # must be saved as .stru - if you have an error, check its extension
     
 Then `R` will ask you to type the answers to these questions directly in the `R Console`:  

 - Question: How many genotypes are there? *(inds*) **Answer**:134 
 - Question: How many markers are there? *(SNPs)* **Answer**: 12456
 - Question: Which column contains the genotype label ('1' if absent)? **Answer**:1
 - Question: Which column contains the population factor ('0' if absent)? **Answer**:2
 - Question: Which other optional columns should be read (press 'return' when done)? **Press return**
 - Question: Which row contains the marker names ('0' if absent)? **Answer**:1
 - Question: Are genotypes coded by a single row (y/n)? **Answer**: n

 If all questions were answered correctly, then it should give you the following message: 

      Converting data from a STRUCTURE .stru file to a genind object... 
      
 Once imported, you can look at your transformed (summarized) *genind* file that the package `adegenet` uses, by typing: 

     myFile

 Now, we can run the code necessary for running a **Principal Components Analysis (PCA)**, but first we need to scale our missing data:

     X <- scaleGen(myFile, NA.method="zero")
     pca1<-dudi.pca(X,cent=FALSE,scale=FALSE,scannf=FALSE,nf=3)
     
 We define our plotting colors (so that pop1=darkgreen and pop2=darkblue), and then we generate our PCA scatterplot and our PC eigenvalues:

     myCol <-c("darkgreen","darkblue")
     s.class(pca1$li,pop(myFile), col=myCol)
     add.scatter.eig(pca1$eig[1:20], 3,1,2)
     
 Now we are interested in finding potential migrant pumas between our populations, so we want to see where individual labels fall within the PCA plot:
     
     s.label(pca1$li)
     
 Hm, that's not very informative. Let's try running a **Discriminant Analysis of Principal Components (DAPC)**, which tries to maximize the difference among pre-defined groups based on the Principal Components. 

     dapc1<-dapc(X,pop(myFile))
 The `R Console` will now ask you a couple of questions based on the graphs. First, it will ask how many principal components you want to keep, we will keep ten for our analysis (so, type `10` into the `R Console`). then, it will ask you how many discriminant functions you want to keep, in this case we only hae two groups thus only one DF, so type `1` into the `R Console`, and then we can see the summary and plot of our DAPC:

     summary(dapc1)
     scatter(dapc1)

     
 Finally, we can visualize the DAPC as a **compoplot**, which is analogous to **STRUCTURE** analyses, where each bar is an individual an the colors are its probability of belonging to a specific group, or similarly, probability of admixture. 

     compoplot(dapc1,posi="bottomright",lab="", ncol=1,xlab="individuals") 
     
 Now we can clearly identify and visualize both migrant individuals and admixed individuals as well. But, it's still impossible to know which individual ID belongs to migrants and to admixed, so we now type:
     
     assignplot(dapc1, subset=1:40)        
     assignplot(dapc1, subset=41:80)
     assignplot(dapc1, subset=81:100)
     assignplot(dapc1, subset=101:134)

 Now we can clearly identify each migrant individual by name!  

 Finally, we can run all the same analyses by tweaking the code just a little bit with this other [dataset](https://github.com/rdtarvin/IBS2019_Genomics-of-Biodiversity/blob/master/files/Msi_GP_in.gen)... can you figure out the PCA colors and how many Principal Components and Discriminant Functions to keep? 


 
<a href="https://pesalerno.github.io/genetica-ago-2020/main/2020/06/10/10_genomica-1.html"><button>Actividad Anterior</button></a>		<a href="https://pesalerno.github.io/genetica-ago-2020/"><button>Inicio</button></a>    <a href="https://pesalerno.github.io/genetica-ago-2020/main/2020/08/01/12_final.html"><button>Siguiente Actividad</button></a>
